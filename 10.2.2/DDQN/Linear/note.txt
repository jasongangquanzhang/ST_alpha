This is only an attempt of using linear method for 10.2.2, but it doesn't
work and needs a lot of debugging, so we decided to just use the random method.